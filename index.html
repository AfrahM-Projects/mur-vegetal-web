<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Mur V√©g√©tal Intelligent</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #eafbe7, #c8e6c9);
      padding: 30px;
      margin: 0;
      color: #2e7d32;
      transition: background 0.4s, color 0.4s;
    }

    .login-box, .app-interface {
      display: none;
      margin: auto;
      max-width: 1000px;
    }

    .login-box.active, .app-interface.active {
      display: block;
    }

    input {
      padding: 10px;
      width: 80%;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
    }

    button {
      background-color: #43a047;
      color: white;
      font-size: 16px;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
      min-width: 130px;
    }

    button:hover {
      background-color: #2e7d32;
      transform: scale(1.05);
    }

    .button-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 20px;
      text-align: center;
    }

    .data {
      background-color: white;
      border-radius: 15px;
      padding: 15px 25px;
      margin: 10px auto;
      font-size: 1.3rem;
      max-width: 400px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .icon {
      width: 30px;
      height: 30px;
    }

    p {
      margin-top: 20px;
      font-size: 1.1rem;
      text-align: center;
    }

    .dark-mode {
      background: linear-gradient(to right, #263238, #37474f);
      color: #ffffff;
    }

    .dark-mode .data {
      background-color: #455a64;
      color: #ffffff;
    }

    .dark-mode button {
      background-color: #607d8b;
    }

    .dark-mode button:hover {
      background-color: #455a64;
    }

    .interface-container {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      justify-content: center;
      gap: 40px;
      align-items: flex-start;
    }

    .left-side img {
      width: 100%;
      max-width: 400px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .right-side {
      flex: 1;
      min-width: 300px;
    }
  </style>
</head>
<body>

  <!-- Page de connexion -->
  <div class="login-box active" id="loginBox">
    <h2 style="text-align:center">üîê Connexion requise</h2>
    <input type="text" id="login" placeholder="Nom d'utilisateur" /><br>
    <input type="password" id="motdepasse" placeholder="Mot de passe" /><br>
    <div style="text-align:center">
      <button onclick="verifierConnexion()">Se connecter</button>
    </div>
    <p id="erreur" style="color:red; text-align:center;"></p>
  </div>

  <!-- Interface principale -->
  <div class="app-interface" id="appInterface">
    <h1>üåø Mur V√©g√©tal Intelligent</h1>

    <div class="interface-container">
      <div class="left-side">
        <img src="images/plant.jpg" alt="Mur v√©g√©tal" />
      </div>

      <div class="right-side">
        <div class="data" id="etatSysteme">
          <img class="icon" src="https://img.icons8.com/ios-filled/50/000000/gear.png" />
          <span>√âtat du syst√®me : Initialisation...</span>
        </div>

        <div class="data" id="humidite">
          <img class="icon" src="https://img.icons8.com/ios-filled/50/000000/water.png" />
          <span>Humidit√© : ...</span>
        </div>

        <div class="data" id="luminosite">
          <img class="icon" src="https://img.icons8.com/ios-filled/50/000000/sun--v1.png" />
          <span>Luminosit√© : ...</span>
        </div>

        <div class="data" id="air">
          <img class="icon" src="https://img.icons8.com/ios-filled/50/000000/air.png" />
          <span>Qualit√© de l'air : ...</span>
        </div>

        <div class="data" id="temperature">
          <img class="icon" src="https://img.icons8.com/ios-filled/50/000000/temperature.png" />
          <span>Temp√©rature : ...</span>
        </div>

        <div class="button-container">
          <button onclick="chargerDonnees()">üîÑ Rafra√Æchir</button>
          <button onclick="activerArrosage()">üí¶ Arroser</button>
          <button onclick="toggleMode()">üåô Mode sombre</button>
          <button onclick="seDeconnecter()">üö™ D√©connexion</button>
        </div>

        <p id="derniereMaj">Derni√®re mise √† jour : ...</p>
      </div>
    </div>
  </div>

  <script>
    const identifiants = {
      utilisateur: "admin",
      motdepasse: "1234"
    };

    let websocket;

    function verifierConnexion() {
      const login = document.getElementById("login").value;
      const motdepasse = document.getElementById("motdepasse").value;

      if (login === identifiants.utilisateur && motdepasse === identifiants.motdepasse) {
        document.getElementById("loginBox").classList.remove("active");
        document.getElementById("appInterface").classList.add("active");
        demarrerWebSocket();
      } else {
        document.getElementById("erreur").textContent = "‚ùå Identifiants incorrects !";
      }
    }

    function chargerDonnees() {
      console.log("üîÑ Rafra√Æchir manuellement (d√©sactiv√© si WebSocket actif)");
    }

    function demarrerWebSocket() {
      websocket = new WebSocket("ws://192.168.5.120:8765"); // ‚Üê adapte ici si besoin

      const etatSysteme = document.getElementById("etatSysteme").querySelector("span");
      const humidite = document.getElementById("humidite").querySelector("span");
      const luminosite = document.getElementById("luminosite").querySelector("span");
      const air = document.getElementById("air").querySelector("span");
      const temperature = document.getElementById("temperature").querySelector("span");
      const derniereMaj = document.getElementById("derniereMaj");

      websocket.onopen = () => {
        etatSysteme.textContent = "√âtat du syst√®me : Connect√© au serveur WebSocket ‚úÖ";
      };

      websocket.onmessage = (event) => {
        try {
          const data = JSON.parse(event.data);
          if (data.humidite) humidite.textContent = "Humidit√© : " + data.humidite + " %";
          if (data.luminosite) luminosite.textContent = "Luminosit√© : " + data.luminosite + " lux";
          if (data.air) air.textContent = "Qualit√© de l'air : " + data.air;
          if (data.temperature) temperature.textContent = "Temp√©rature : " + data.temperature + " ¬∞C";
          derniereMaj.textContent = "Derni√®re mise √† jour : " + new Date().toLocaleString();
          etatSysteme.textContent = "√âtat du syst√®me : Donn√©es mises √† jour ‚úÖ";
        } catch (e) {
          console.error("‚ùå Erreur parsing donn√©es WebSocket :", e);
        }
      };

      websocket.onerror = () => {
        etatSysteme.textContent = "√âtat du syst√®me : Erreur de connexion WebSocket ‚ùå";
      };

      websocket.onclose = () => {
        etatSysteme.textContent = "√âtat du syst√®me : Connexion WebSocket ferm√©e";
      };
    }

    function activerArrosage() {
      alert("Syst√®me d‚Äôarrosage activ√© üíß");
      document.getElementById("etatSysteme").querySelector("span").textContent = "√âtat du syst√®me : Arrosage en cours...";
    }

    function toggleMode() {
      document.body.classList.toggle("dark-mode");
    }

    function seDeconnecter() {
      if (websocket) websocket.close();
      document.getElementById("appInterface").classList.remove("active");
      document.getElementById("loginBox").classList.add("active");
      document.getElementById("login").value = "";
      document.getElementById("motdepasse").value = "";
      document.getElementById("erreur").textContent = "";
      document.body.classList.remove("dark-mode");
    }
  </script>
</body>
</html>
